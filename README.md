---
title: ""
output: html_document
date: "2023-05-24"
author: "Hélène Cecilia"
---


====================

This repository contains code used in the following paper.

Hanley KA, Cecilia H, Azar SR, Moehn B, Wanqin Y, Ruimei Y, Althouse BM, Vasilakis N, Rossi SL (2023) **Immunologically mediated trade-offs shaping transmission of sylvatic dengue and Zika virus in native and novel non-human primate hosts.** *bioRxiv* [https://doi.org/10.1101/2023.06.30.547187](https://doi.org/10.1101/2023.06.30.547187)

All code contained within this repository is released under the [CRAPL v0.1 License](http://matt.might.net/articles/crapl/). Data provided in this repository are sufficient to rerun all analyses.

The analyses were all performed on a desktop computer (Ubuntu 22.04) 

====================

### Set up of code base: 

* `script` contains code to analyze the data, perform calculations, and generate output and figures 
* `data` contains experimental data described in manuscript. Read by scripts from the `script` folder
* `output` contains results generated by scripts in the `script` folder. 

### Script folder
*Note : some scripts are in the quarto format (.qmd), which is similar to R Markdown (see [quarto.org](https://quarto.org/)). It is for long scripts that benefit from being executed in chunks, but the programming language used is still R.*

* `Monkeys_Temperature_Weight.R` produces **Figures S1 and S2**.
* `Statistical_Tests_Miscellaneous.R` regroups the various tests performed on the datasets using generalized linear models. Comments structure the file and specify the hypotheses tested.
* `Cytokines_NK_Cells.R` tests association between IL-12 and %NK cells in cynomolgus macaques. It produces **Figures S3 and S4**. Model objects are saved in `output/result_files/cytokines/mixed_effect_models/correlation_NK_cells/`
* `Cytokines_Sex_Diff_at_Baseline.R` tests if differences in cytokine concentrations exists between sexes before the start of the experiments. Levene's test for heterogeneity of variance, followed by a Wilcoxon test, two-sided. Results are saved in `output/result_files/cytokines/sex_diff_at_baseline/`
* `Cytokines_Baseline_vs_Day28.R` tests if the long-term equilibrium of cytokines is altered, by checking differences between baseline concentrations and day 28 of the experiments. Paired Wilcoxon test, two-sided. Results are saved in `output/result_files/cytokines/baseline_vs_day28/`
* `Cytokines_Functions.R` contains functions used in `Cytokines_Sex_Diff_at_Baseline.R` and `Cytokines_Baseline_vs_Day28.R` 
* `Dose_Delivered_by_Mosquitoes.qmd` tests if monkeys received the same number of infectious bites across experiments, as well as differences in saliva titers between mosquitoes infected with DENV and ZIKV. It then estimates dose delivered to monkeys, and compares across experiments.
* `Cytokines_GLMM_Infection_Virus_Host_Effects.R` tests through generalized linear mixed effect models if cytokine concentrations differ by infection status, virus species, or host species. It produces **Figures S5 and S7**. Results are saved in `output/result_files/cytokines/mixed_effect_models/effect_infection_virus_monkey_species/`
* `TransmissionToMosquitoes_ZIKV_DENV_Sylvatic.R` fits a generalized additive model (gam) to compute a relationship between monkeys' viral titer and probability of transmission to mosquitoes. For DENV, data from cynomolgus macaques and squirrel monkeys are aggregated. For both ZIKV and DENV, the probability of transmission is broadly defined as mosquito legs or bodies or saliva being positive. This script produces **Figure 4** from the manuscript. Model objects are saved in `output/result_files/transmission_to_mosquitoes/GAM_zika_dengue_sylvatic/`.
* `Dose_Response_ZIKV_MonkeyToAlbopictus_vs_DENV_HumanToAegypti.qmd` performs the selection of functional forms to fit dose-response curves to ZIKV and DENV transmission data to mosquitoes (bodies or legs). It produces **Figures 5, S9, S10**. Model objects are saved in `output/result_files/transmission_to_mosquitoes/zika_sylvatic_vs_dengue_literature/`.
* `Dose_Response_Functions.R` contains functions used to fit dose-response curves and select the most appropriate functional form, as well as computeing uncertainty around the curves, and estimating dose 50.

### Data folder
Tables S1, S2, S3 contain most of the data. The .csv files are used by the scripts, and the .xlsx version is provided as it has a separate sheet detailing column information. Temperature files provide temperature every 15 minutes. Other files are extractions of Tables S1-S3 used for easier manipulation in scripts. Although the file names refer to the experiment with the virus name, they also include control monkeys.

The `literature` folder contains data from Nguyen et al. 2013 and Duong et al. 2015, extracted from the supplementary material of ten Bosch et al. 2018, used for comparison between ZIKV transmission from squirrel monkeys to Aedes albopictus and DENV transmission from humans to Aedes aegypti.

### Output folder
#### Figure subfolder 
Contains figures from the manuscript (in `main`) and the supplementary information (in `suppl`), numbered accordingly.

#### Result_files subfolder 
Contains detailed results from analysis.

Any questions about this code base can be directed at helene.cecilia3@gmail.com

### References
Nguyen, N. M. et al. Host and viral features of human dengue cases shape the population of infected and infectious Aedes aegypti mosquitoes. *Proc. Natl. Acad. Sci. U.S.A.* **110**, 9072–9077 (2013).

Duong, V. et al. Asymptomatic humans transmit dengue virus to mosquitoes. *Proc. Natl. Acad. Sci. U.S.A.* **112**, 14688–14693 (2015).

ten Bosch, Q. A. et al. Contributions from the silent majority dominate dengue virus transmission. *PLOS Pathogens* **14**, e1006965 (2018).
